<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<title>PCB layout</title>
<link rel="stylesheet" href="./../../asciidoctor.css">
</head>
<body class="article">
<div id="header">
<h1>PCB layout</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of contents</div>
<ul class="sectlevel1">
<li><a href="#_design_rules">Design rules</a></li>
<li><a href="#_layers">Layers</a></li>
<li><a href="#_general_steps">General steps</a></li>
<li><a href="#_component_placement">Component placement</a>
<ul class="sectlevel2">
<li><a href="#_decoupling_capacitors">Decoupling capacitors</a></li>
<li><a href="#_esd_protection">ESD protection</a></li>
</ul>
</li>
<li><a href="#_routing">Routing</a>
<ul class="sectlevel2">
<li><a href="#_track_widths">Track widths</a></li>
<li><a href="#_vias">Vias</a></li>
<li><a href="#_current_return_paths">Current return paths</a></li>
<li><a href="#_copper_areas">Copper areas</a></li>
<li><a href="#_thermal_pads">Thermal pads</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_design_rules">Design rules</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>PCB manufactures have certain requirements that the design must follow to be manufacturable without problems.</p>
<div class="ulist">
<ul>
<li>
<p>JLCPCB has requirements on this page: <a href="https://jlcpcb.com/capabilities/Capabilities" class="bare">https://jlcpcb.com/capabilities/Capabilities</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>PCB design software can usually check the requirements during component placement and routing.
Requirements can also be manually checked with DRC (design rules check).</p>
</li>
<li>
<p>Design rules should be changed in the design software based on the manufacturer&#8217;s requirements/capabilities before starting PCB layout.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_layers">Layers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It&#8217;s recommended to use 4 layers:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Signals and power (top)</p>
</li>
<li>
<p>GND</p>
</li>
<li>
<p>GND</p>
</li>
<li>
<p>Signals and power (bottom)</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_general_steps">General steps</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start with initial component placement.
Majority of time should be spent in this step to make routing the signals easier.</p>
</li>
<li>
<p>Route the signals and connect power and ground with vias to internal layers.
Adjust component placement where necessary to make room for vias and tracks or to bring components closer to each other.</p>
</li>
<li>
<p>Create power and ground copper areas on internal layers.
It&#8217;s also useful to add ground copper areas on top and bottom layers for better thermal performance.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_component_placement">Component placement</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Use airwires to find good location and orientation for components.</p>
<div class="ulist">
<ul>
<li>
<p>Try to make airwires as short as possible to have short tracks.</p>
</li>
<li>
<p>Find signals that are crossing each other.
Then swap the pins on the schematic if possible or adjust the components placement or move components to bottom layer.
It&#8217;s easier to route the signals if tracks are not crossing each other.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Place larger components first and then place smaller components next to the larger ones.</p>
<div class="ulist">
<ul>
<li>
<p>For example place microcontroller first and then place decoupling capacitors next to the pins.
Then place resistors close to the microcontroller.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_decoupling_capacitors">Decoupling capacitors</h3>
<div class="ulist">
<ul>
<li>
<p>Place decoupling capacitors as close as possible to power pins.</p>
<div class="ulist">
<ul>
<li>
<p>This reduces the noise that could picked up on the longer track.</p>
</li>
<li>
<p>Shorter tracks also resist the current flow less.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Connect power and ground with vias.</p>
<div class="ulist">
<ul>
<li>
<p>Avoid placing vias between component pins and decoupling capacitor.</p>
</li>
<li>
<p>Current should flow from power supply to capacitor and from decoupling capacitor to the component.</p>
</li>
<li>
<p>When tha components are hand soldered, then it&#8217;s fine to place the vias inside the capacitor&#8217;s pads.</p>
</li>
<li>
<p>When reflow soldering, vias would need to be plugged/filled first to avoid solder paste flowing into the via holes.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/pcb_layout_decoupling_capacitor.png" alt="Decoupling capacitor connection">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_esd_protection">ESD protection</h3>
<div class="paragraph">
<p>Place ESD protection components as close to the connector as possible.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_routing">Routing</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_track_widths">Track widths</h3>
<div class="ulist">
<ul>
<li>
<p>Current carrying capability should be considered when choosing the width for a track.</p>
<div class="ulist">
<ul>
<li>
<p>Wider tracks have less resistance and can carry more current.</p>
</li>
<li>
<p>Calculators can be used to calculate track widths and other properties:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.digikey.ee/en/resources/conversion-calculators/conversion-calculator-pcb-trace-width" class="bare">https://www.digikey.ee/en/resources/conversion-calculators/conversion-calculator-pcb-trace-width</a></p>
</li>
<li>
<p><a href="https://saturnpcb.com/pcb_toolkit/" class="bare">https://saturnpcb.com/pcb_toolkit/</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Wider tracks are also mechanically more robust, which can be useful when doing hand soldering or rework.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_vias">Vias</h3>
<div class="ulist">
<ul>
<li>
<p>Via size can be calculated by current capability.</p>
<div class="ulist">
<ul>
<li>
<p>Multiple smaller vias can be used in parallel instead of one larger via.</p>
</li>
<li>
<p>Calculators can be used to calculate via properties:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://saturnpcb.com/pcb_toolkit/" class="bare">https://saturnpcb.com/pcb_toolkit/</a></p>
</li>
<li>
<p><a href="http://circuitcalculator.com/wordpress/2006/03/12/pcb-via-calculator/" class="bare">http://circuitcalculator.com/wordpress/2006/03/12/pcb-via-calculator/</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_current_return_paths">Current return paths</h3>
<div class="ulist">
<ul>
<li>
<p>Current return paths should be considered when placing components and routing tracks.</p>
</li>
<li>
<p>Current tends to flow through the path of least impedance.</p>
<div class="ulist">
<ul>
<li>
<p>Electrical impedance is a combination of resistance, capacitive reactance and inductive reactance.</p>
</li>
</ul>
</div>
</li>
<li>
<p>At low frequencies current flows through the shortest (least resistance) path.</p>
</li>
<li>
<p>With higher frequencies, more return current will flow underneath the track on the path of least impedance.</p>
<div class="ulist">
<ul>
<li>
<p>For example if the track is on the first layer, and the ground area is on the second layer,
then at higher frequencies the return current tends to flow through the ground area below the track on the first layer.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Area enclosed with forward and return current is called current loop.</p>
<div class="ulist">
<ul>
<li>
<p>Larger current loops create more noise.</p>
</li>
<li>
<p>Loop area should be minimized by placing components close to each other, using short tracks
and making sure the return current can flow through the path of least impedance.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>More information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://resources.altium.com/p/what-return-current-path-pcb" class="bare">https://resources.altium.com/p/what-return-current-path-pcb</a></p>
</li>
<li>
<p><a href="https://www.maximintegrated.com/en/design/technical-documents/tutorials/5/5450.html" class="bare">https://www.maximintegrated.com/en/design/technical-documents/tutorials/5/5450.html</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_copper_areas">Copper areas</h3>
<div class="ulist">
<ul>
<li>
<p>Copper areas (polygon pour) can be used to connect nets (ground, power, motor driver outputs)
that carry higher currents.</p>
</li>
<li>
<p>Avoid creating large gaps in ground planes by placing vias close to each other.</p>
<div class="ulist">
<ul>
<li>
<p>Current has to flow around the gaps which can create larger current loops.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/pcb_layout_vias_gap.png" alt="Gap from vias">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_thermal_pads">Thermal pads</h3>
<div class="paragraph">
<p>Connect thermal pads to the ground copper areas with multiple vias.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/pcb_layout_thermal_pad_vias.png" alt="Thermal pad vias">
</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>